<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- *************************** dao interface 경로+이름 -->
<mapper namespace="com.example.coding.dao.TouroviewDAO">

<!-- touroview_insert-->
<!-- 후기 게시물 db저장-->
<insert id="saveTouroview">
        INSERT INTO touroview (user_id, tour_num, touroview_title, touroview_regdate, touroview_update, touroview_content)
        VALUES (#{user_id}, #{tour_num}, #{touroview_title}, #{touroview_regdate}, #{touroview_update}, #{touroview_content});
</insert>
  
<!-- 후기 게시물 사진 db 저장-->
<!-- <insert id="insertviewImage" parameterType="ImgVO">
        INSERT INTO img (img_name, img_real_name, img_size, img_width, img_length)
        VALUES (#{imgName}, #{imgRealName}, #{imgSize}, #{imgWidth}, #{imgLength})
</insert> -->


<!-- touroview_detail-->
<!-- detail페이지 db 목록 불러오기-->
<select id="getTouroviewList" resultType="TouroviewVO">
    SELECT * 
    FROM touroview
    <where>
        <if test="searchKeyword != null and searchKeyword.length() > 0">
            AND touroview_title LIKE CONCAT('%', #{searchKeyword}, '%')
        </if>
    </where>
</select>

<!-- 모든 페이지 수 가져오기-->
<select id="getTotalPages" resultType="int">
        SELECT COUNT(*)
        FROM touroview;
    </select>

<!-- 여행지 검색-->
<select id="findByKeyword" parameterType="TourVO" resultType="TourVO"> 
    SELECT * 
    FROM tour
    WHERE tour_name LIKE CONCAT('%', #{keyword}, '%') OR tour_addr LIKE CONCAT('%', #{keyword}, '%');
</select>

<!-- TourVO에서 여행지 우편번호, 주소 받아오기 -->
<select id="getTourById" resultType="TourVO">
    SELECT *
    FROM tour
    WHERE tour_num = #{tour_num}
</select>




<!-- touroview_-->
<!-- 게시물 수정-->
<update id="updateTouroview" parameterType="TouroviewVO">
        UPDATE touroview
        SET    touroview_title = #{touroviewTitle},
               touroview_content = #{touroviewContent},
        WHERE  touroview_num     = #{touroviewNum}
</update>

<!-- 게시물 삭제-->
<delete id="deleteTouroview" parameterType="int">
        DELETE FROM touroview
        WHERE  touroview_num = #{touroviewNum}
</delete>

</mapper>
