<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.coding.dao.TourListDAO">

<select id="selectAll" resultType="com.example.coding.domain.TourVO" parameterType="com.example.coding.domain.Search">
	SELECT *
	FROM tour 
	<trim prefix="WHERE" prefixOverrides="AND|OR">
			<if test="tour_cate_code != null and tour_cate_code != '' ">
				AND tour_cate_code like #{tour_cate_code}
			</if>
			<if test="keyword != null and keyword != '' ">
				AND tour_name like  CONCAT('%',#{keyword},'%') 
				OR tour_content like CONCAT('%',#{keyword},'%')
			</if>
		</trim>
	
	ORDER BY tour_num DESC 
	LIMIT #{startList}, #{listSize}
</select>

<select id="tourListCnt" resultType="int" parameterType="com.example.coding.domain.Search">
		SELECT count(*) as listCnt
		FROM tour 
		<trim prefix="WHERE" prefixOverrides="AND|OR">
				<if test="tour_cate_code != null and tour_cate_code != '' ">
					AND tour_cate_code like #{tour_cate_code}
				</if>
				<if test="keyword != null and keyword != '' ">
					AND tour_name like CONCAT('%',#{keyword},'%') 
					OR tour_content like CONCAT('%',#{keyword},'%')
				</if>
		</trim>
	</select>

<select id="selectOne" resultType="com.example.coding.domain.TourVO" parameterType="com.example.coding.domain.TourVO">
	SELECT * 
	FROM tour 
	WHERE tour_num=#{tour_num} 
</select>

<insert id="addWishList" parameterType="com.example.coding.domain.WishListVO">
	INSERT INTO wishlist (user_id, tour_num)
	VALUES (#{user_id}, #{tour_num})
</insert>

<select id="ckWishList" resultType="int" parameterType="com.example.coding.domain.WishListVO">
	SELECT * 
	FROM wishlist 
	WHERE user_id = #{user_id} AND tour_num = #{tour_num}
</select>
</mapper>